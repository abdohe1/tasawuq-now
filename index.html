<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªØ³ÙˆÙ‚ Ø§Ù„Ø¢Ù†</title>

<style>
*{box-sizing:border-box;font-family:Tajawal,Arial}
body{margin:0;background:#f2f4f8}

/* HEADER */
header{
  background:#0d6efd;
  color:#fff;
  padding:20px;
  text-align:center;
  border-bottom-left-radius:24px;
  border-bottom-right-radius:24px;
}
header h1{margin:0}
nav button{
  background:#fff;
  color:#0d6efd;
  border:none;
  padding:10px 16px;
  margin:5px;
  border-radius:14px;
  font-weight:bold;
}

/* COMMON */
.page{display:none;padding:15px}
#home{display:block}
input,select{
  width:100%;
  padding:12px;
  margin-bottom:10px;
  border-radius:12px;
  border:1px solid #ddd;
}

/* SEARCH */
.search input{border:none}

/* CATEGORIES */
.categories{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px;
}
.cat{
  background:#fff;
  padding:14px;
  border-radius:16px;
  text-align:center;
  font-weight:bold;
}

/* POSTS */
.post{
  background:#fff;
  border-radius:18px;
  padding:15px;
  margin:15px 0;
}
.price{color:#198754;font-weight:bold}

/* BUTTONS */
.actions{display:flex;gap:10px;margin-top:10px}
button{
  padding:10px;
  border:none;
  border-radius:12px;
  font-weight:bold;
}
.edit{background:#198754;color:#fff}
.delete{background:#dc3545;color:#fff}
.chat{background:#0d6efd;color:#fff}

/* CHAT */
.chat-box{
  background:#fff;
  border-radius:18px;
  padding:10px;
  height:300px;
  overflow-y:auto;
  margin-bottom:10px;
}
.msg{
  margin:5px 0;
  padding:8px 12px;
  border-radius:14px;
  max-width:80%;
}
.me{background:#0d6efd;color:#fff;margin-left:auto}
.other{background:#eee}

/* BOTTOM */
.bottom{
  position:fixed;
  bottom:0;left:0;right:0;
  background:#fff;
  display:flex;
  justify-content:space-around;
  padding:10px 0;
  border-top:1px solid #ddd;
}
body{padding-bottom:70px}
</style>
</head>

<body>

<header>
  <h1>ğŸ›’ ØªØ³ÙˆÙ‚ Ø§Ù„Ø¢Ù†</h1>
  <nav>
    <button onclick="show('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
    <button onclick="show('add')">Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù†</button>
    <button onclick="show('dashboard')">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>
  </nav>
</header>

<!-- HOME -->
<div id="home" class="page">
  <div class="search">
    <input id="search" placeholder="ğŸ” Ø§Ø¨Ø­Ø«" oninput="render()">
  </div>

  <div class="categories">
    <div class="cat" onclick="setCat('all')">Ø§Ù„ÙƒÙ„</div>
    <div class="cat" onclick="setCat('Ø³ÙŠØ§Ø±Ø§Øª')">Ø³ÙŠØ§Ø±Ø§Øª</div>
    <div class="cat" onclick="setCat('Ø¯Ø±Ø§Ø¬Ø§Øª')">Ø¯Ø±Ø§Ø¬Ø§Øª</div>
    <div class="cat" onclick="setCat('Ø£Ù„Ø¹Ø§Ø¨')">Ø£Ù„Ø¹Ø§Ø¨</div>
  </div>

  <div id="posts"></div>
</div>

<!-- ADD -->
<div id="add" class="page">
  <h3>Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù†</h3>
  <input id="username" placeholder="Ø§Ø³Ù…Ùƒ">
  <input id="title" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†">
  <input id="price" placeholder="Ø§Ù„Ø³Ø¹Ø±">
  <select id="category">
    <option>Ø³ÙŠØ§Ø±Ø§Øª</option>
    <option>Ø¯Ø±Ø§Ø¬Ø§Øª</option>
    <option>Ø£Ù„Ø¹Ø§Ø¨</option>
  </select>
  <button class="edit" onclick="save()">Ø­ÙØ¸</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="page">
  <h3>Ø¥Ø¹Ù„Ø§Ù†Ø§ØªÙŠ</h3>
  <div id="myPosts"></div>
</div>

<!-- CHAT -->
<div id="chat" class="page">
  <h3 id="chatTitle"></h3>
  <div class="chat-box" id="chatBox"></div>
  <input id="msgInput" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©">
  <button class="chat" onclick="sendMsg()">Ø¥Ø±Ø³Ø§Ù„</button>
</div>

<div class="bottom">
  <button onclick="show('home')">ğŸ </button>
  <button onclick="show('add')">â•</button>
  <button onclick="show('dashboard')">ğŸ‘¤</button>
</div>

<script>
let posts = JSON.parse(localStorage.getItem("posts"))||[];
let chats = JSON.parse(localStorage.getItem("chats"))||{};
let currentCat="all";
let currentChat=null;

function show(id){
  document.querySelectorAll('.page').forEach(p=>p.style.display='none');
  document.getElementById(id).style.display='block';
}

function setCat(c){currentCat=c;render();}

function save(){
  if(!username.value||!title.value||!price.value)return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
  posts.push({
    user:username.value,
    title:title.value,
    price:price.value,
    category:category.value,
    id:Date.now()
  });
  localStorage.setItem("posts",JSON.stringify(posts));
  render(); show('home');
}

function render(){
  postsDiv.innerHTML="";
  const q=search.value.toLowerCase();
  posts.filter(p=>
    (currentCat==="all"||p.category===currentCat)&&
    p.title.toLowerCase().includes(q)
  ).forEach(p=>{
    postsDiv.innerHTML+=`
    <div class="post">
      <b>${p.title}</b>
      <div>${p.category}</div>
      <div class="price">${p.price}</div>
      <button class="chat" onclick="openChat(${p.id},'${p.title}')">Ø¯Ø±Ø¯Ø´Ø©</button>
    </div>`;
  });
}

function openChat(id,title){
  currentChat=id;
  chatTitle.innerText="Ø¯Ø±Ø¯Ø´Ø©: "+title;
  renderChat();
  show('chat');
}

function renderChat(){
  chatBox.innerHTML="";
  (chats[currentChat]||[]).forEach(m=>{
    chatBox.innerHTML+=`<div class="msg ${m.me?'me':'other'}">${m.text}</div>`;
  });
}

function sendMsg(){
  if(!msgInput.value)return;
  chats[currentChat]=chats[currentChat]||[];
  chats[currentChat].push({text:msgInput.value,me:true});
  localStorage.setItem("chats",JSON.stringify(chats));
  msgInput.value="";
  renderChat();
}

function loadDashboard(){
  myPosts.innerHTML="";
  posts.forEach(p=>{
    myPosts.innerHTML+=`<div class="post">${p.title} - ${p.price}</div>`;
  });
}

render();
</script>

</body>
</html>
